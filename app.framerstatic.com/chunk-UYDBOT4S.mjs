import{k as ge,m as be}from"https://app.framerstatic.com/chunk-WW7ZRIP2.mjs";import{Ka as L,Zc as he,nc as ve,yc as Ce}from"https://app.framerstatic.com/chunk-NBGN6U2B.mjs";import{$s as me,Bc as ie,Ec as w,Ks as ue,Mj as ae,Nq as de,Or as O,Pp as B,Ps as fe,Rr as j,Yq as z,_q as H,_s as pe,ar as ce,at as E,bt as W,er as F,gb as R,mb as M,oe as ne,re as oe,u as S,um as le,we as se,xc as f,zt as ye}from"https://app.framerstatic.com/chunk-L7L7BWTW.mjs";import{w as X}from"https://app.framerstatic.com/chunk-INOXWMPK.mjs";import{p as N}from"https://app.framerstatic.com/chunk-65XKJBP2.mjs";import{a as Y,b as P,d as Z,e as T,f as ee,i as u,l as A,o as te,r as re}from"https://app.framerstatic.com/chunk-ZQUNXESX.mjs";import{s as J,v as Q}from"https://app.framerstatic.com/chunk-PNIOO2GU.mjs";import{a as y,b as $}from"https://app.framerstatic.com/chunk-WNSBRACC.mjs";import{j as V}from"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";var Ae=Q("initializeAssetResolver"),k,_;function Oe(t){if(k)throw new Error("initializeAssetResolver() should only be called once");return Ae.debug("initializeAssetResolver",{assetMap:t}),k=X(J().userContent,t),_=t,k}function Ne(){if(k===void 0)throw new Error("getAssetResolver() should not be called before initializeAssetResolver()");return k}function je(){if(_===void 0)throw new Error("getCurrentAssetMapHash() should not be called before initializeAssetResolver()");let t=Ne(),e=_.hash;return{assetResolver:t,assetMapHash:e}}function Le(){S.frame.addScope("is-hidden",1500),S.component.addScope("is-hidden",1500)}function Se(){S.frame.removeScope("is-hidden"),S.component.removeScope("is-hidden")}function q(t,e,i){if(u(t.hidden))return!1;if(Y(t.hidden))return t.hidden;try{Le();let o=t.hidden(e,i);return Se(),o}catch{return Se(),!1}}var Re=class{constructor(e){this.engine=e}async requestHiddenStateForComponentControls(e){let i=e.args,o=this.engine.tree,r={};return Object.entries(i).forEach(([n,{controlNames:a}])=>{let s=o.getNode(n);if(!s)return;y(ye(s),"Node is not a CanvasNode with control props (node.__class: ",s.__class,")");let d=s.getControlPropSourceIdentifier();y(d,"Cannot find component identifier for node");let l=R.reactComponentForIdentifier(d);if(!l||!l.properties)return;let p=a??Object.keys(l.properties),b=s.getResolvedControlPropValues(R);r[n]=ke(p,l,b)}),{hiddenControlsByNodeId:r}}async requestHiddenStateForActionControls(e){let{actionIdentifier:i,controlNames:o,actionProps:r}=e;y(i,"Fail to request hidden state for action controls: missing actionIdentifier");let n=R.componentForIdentifier(i);return{hiddenState:o.reduce((s,d)=>{let l=n?n.properties[d]:void 0;return l?(s[d]=q(l,r,r),s):(s[d]=!1,s)},{})}}async requestHiddenStateForModuleControls(e){let i=R.reactComponentForIdentifier(e.moduleIdentifier);return i?.properties?{hiddenState:ke(e.controlNames??Object.keys(i.properties),i,e.moduleProps)}:{hiddenState:{}}}};function U(t,e,i,o,r,n){let a=t+e;if(i){if(i.hidden&&(n[a]=q(i,o,r)),i.type==="object"){let s=o[e];if(!T(s))return;for(let d in i.controls){let l=i.controls[d];U(a+".",d,l,s,r,n)}}if(i.type==="array"&&i.control.type==="object"){let s=o[e];if(!ee(s))return;let d=s.length;for(let l=0;l<d;l++){let p=s[l];if(T(p))for(let b in p){let x=i.control.controls[b];U(a+`[${l}].`,b,x,p,r,n)}}}}}function ke(t,e,i){let o={};for(let r of t){let n=e.properties[r];U("",r,n,i,i,o)}return o}var Ie=class{constructor(e){this.environment=e;V(this,"visibleRenderIds",new Set);V(this,"addedRenderIds",new Set);V(this,"removedRenderIds",new Set)}setVisible(e,i){y(this.environment==="sandbox","Setting data is only allowed in the sandbox.");let o=this.getVisible(e);i!==o&&(i?(this.visibleRenderIds.add(e),this.addedRenderIds.add(e),this.removedRenderIds.delete(e)):(this.visibleRenderIds.delete(e),this.removedRenderIds.add(e),this.addedRenderIds.delete(e)))}import(e){y(this.environment==="editor","Importing data is only allowed in the editor.");let i=new Set;for(let o of e.addedRenderIds)this.visibleRenderIds.add(o),i.add(o);for(let o of e.removedRenderIds)this.visibleRenderIds.delete(o),i.add(o);return i}getVisible(e){return this.visibleRenderIds.has(e)}export(){y(this.environment==="sandbox","No need to collect and send updates from within the editor.");let e=Array.from(this.addedRenderIds),i=Array.from(this.removedRenderIds);return this.addedRenderIds.clear(),this.removedRenderIds.clear(),{addedRenderIds:e,removedRenderIds:i}}};function xe(t,e,i){if(!t||!oe(t)){e.cache.parentDirected=void 0;return}e.cache.parentDirected=t.layout,se(t)&&(e.cache.parentDirectedRowHeightFitContent=t.gridRowHeightType==="fit",e.cache.parentDirectedColumnCount=Z(t.gridColumnCount)?t.gridColumnCount:void 0),f(t.stackDirection)&&i?e.cache.parentDirection=t.resolveValue("stackDirection")??ne:e.cache.parentDirection=t.stackDirection??null,le(t)&&(e.cache.parentWidthType=t.widthType,e.cache.parentHeightType=t.heightType)}function ot(t,e){xe(t,e,!1)}function st(t,e){xe(t,e,!0)}function gt(t,e){let i=ue(fe),o=N.isOn("pasteMarkdown")?E(t,i):W(t,{supportsStyles:!0}),r={},n=[],a=[],s=[],d=[];o.doc.descendants(c=>{if(H(c)){let v={blockStyles:c.attrs.blockStyles,inlineStyles:c.attrs.inlineStyles,textStylePreset:c.attrs.textStylePreset},g=r[c.attrs.tag]??[];g.push(v),r[c.attrs.tag]=g}if(z(c)){let v=!1,g=!1,C,h;for(let m of c.marks)v||=F(m),g||=j(m),ce(m)&&(h??=m.attrs),O(m)&&n.push(m.attrs.linkStylePreset),de(m)&&(C=m.attrs.inlineStyles);d.push(h),v&&a.push(C),g&&s.push(C)}});let l=N.isOn("pasteMarkdown")?E(e,i):W(e,{supportsStyles:!0}),p=l.tr,b=new Map;l.doc.descendants((c,v,g)=>{if(H(c)){let C=r[c.attrs.tag]??[],h=C.length>1?C.shift():C[0];h&&(b.set(c,h.inlineStyles),p.setNodeMarkup(v,c.type,{...c.attrs,...h}))}if(z(c)){let C=!1,h=!1,m=g?b.get(g):void 0;for(let D of c.marks)if(C||=F(D),h||=j(D),O(D)){let Pe=n.length>1?n.shift():n[0];p.addMark(v,v+c.nodeSize,i.marks.link.create({...D.attrs,linkStylePreset:Pe}))}C&&(m=a.length>1?a.shift():a[0]),h&&(m=s.length>1?s.shift():s[0]),m&&p.addMark(v,v+c.nodeSize,i.marks.inlineStyles.create({inlineStyles:m}));let K=d.length>1?d.shift():d[0];K&&p.addMark(v,v+c.nodeSize,i.marks.backgroundMask.create(K))}});let x=l.apply(p);return N.isOn("pasteMarkdown")?pe(x.doc,i):me(x.doc,!0)}function Te(t){if(M(t))return t.type===void 0?t:{...t,type:void 0,value:he(t.value)}}function Me(t,e){if(M(t))return t.type==="rich-text"?t:{...t,type:"rich-text",value:Ce(e,t.value)}}function xt(t,e,i){switch(t){case"text":return Te(e);case"rich-text":return Me(e,i);default:$(t)}}function Lt(t){let e=new Map;for(let i of t)i.type!=="divider"&&e.set(i.id,i);return e}function we(t,e,i,o,r,n){if(e.type!=="string"||P(i?.value))return;let a=o.get(t);if(a?.type!=="string"||a.fallbackValue!=="associatedVariable")return;let s=a.associatedStringVariable;if(te(s))return;let d=n.getControlProp(s),l=r[s];if(u(l))return;let p=B(l,d);if(p?.type==="string")return p}function Tt(t,e,i,o,r){let n=r.getControlProp(t),s=we(t,e,n,i,o,r)??B(e,n);if(be(s))return s}function De({control:t,controlProp:e,resolvers:i,locale:o}){switch(e.type){case"array":{y(t.type==="array","Invalid control");let{value:r}=e;if(f(r))return;let n=r.map(a=>De({control:t.control,controlProp:a,resolvers:i,locale:o})??null);return{type:"array",value:n}}case"boolean":{let{value:r}=e;return f(r)?void 0:{type:"boolean",value:r}}case"collectionreference":{let{value:r}=e;return f(r)||u(r)?void 0:{type:"string",value:r}}case"color":{let{value:r}=e;if(f(r)||A(r))return;let n=i.resolveColor(r);return u(n)?void 0:{type:"color",value:n}}case"date":{y(t.type==="date","Invalid control");let{value:r}=e;if(f(r)||u(r))return;let n=new Date(r);return re(n)?(t.displayTime||n.setUTCHours(0,0,0,0),{type:"date",value:n.toISOString()}):void 0}case"enum":{let{value:r}=e;return f(r)||u(r)?void 0:(y(P(r),"Enum is not a string"),{type:"enum",value:r})}case"file":{let{value:r}=e;if(f(r)||u(r))return;let n=i.resolveFile(r);return u(n)?void 0:{type:"file",value:n}}case"image":{let r=I(t,e.valueLocalized,o),n=r?.value??e.value;if(f(n)||u(n))return;let a=r?.imageFocalPoint??e,s=i.resolveImage(n,a);if(u(s))return;let l=I(t,e.altLocalized,o)?.value??e.alt;return{type:"responsiveimage",value:{...s,alt:l}}}case"link":{let r=w(e.value);if(ie(r)){let a=I(t,e.valueLocalized,o);a?.value&&(r=w(a.value))}if(f(r)||u(r))return;let n=i.resolveLink(r);return u(n)?void 0:{type:"link",value:n}}case"multicollectionreference":{let{value:r}=e;return f(r)||u(r)?void 0:{type:"array",value:r.map(n=>({type:"string",value:n}))}}case"number":{let{value:r}=e;return f(r)?void 0:{type:"number",value:r}}case"object":{y(t.type==="object","Invalid control");let{value:r}=e;if(f(r)||A(r))return;let n=ve(t.controls,(a,s)=>{let d=r[a];return d?De({control:s,controlProp:d,resolvers:i,locale:o})??null:null});return ae(e)&&(n[L]={type:"string",value:e.id}),{type:"object",value:n}}case"richtext":{let n=I(t,e.valueLocalized,o)?.value??e.value;if(f(n)||ge(n))return;let a=i.resolveRichTextPointer(n);return u(a)?void 0:{type:"richtext",value:a}}case"string":{let n=I(t,e.valueLocalized,o)?.value??e.value;return f(n)?void 0:{type:"string",value:n}}case"vectorsetitem":{let{value:r}=e;if(f(r)||u(r))return;let n=i.resolveVectorSetItemPointer(r);return u(n)?void 0:{type:"vectorsetitem",value:n}}default:}}function I(t,e,i){if(!(!e||!i||ze(t)))for(;i;){let r=e[i.id];if(r&&!A(r.value))return r;i=i.fallback}}function ze(t){return"preventLocalization"in t?t.preventLocalization??!1:!1}function Ve(t,e=i=>i){switch(t.type){case"array":{let i=Ve(t.control,e);return i.definitions[L]={type:e("string"),isNullable:!1},{type:e("array"),isNullable:!0,definition:i}}case"boolean":case"color":case"date":case"enum":case"file":case"link":case"number":case"richtext":case"string":return{type:e(t.type),isNullable:!0};case"collectionreference":return{type:e("string"),isNullable:!0};case"image":case"responsiveimage":return{type:e("responsiveimage"),isNullable:!0};case"multicollectionreference":return{type:e("array"),isNullable:!0,definition:{type:e("string"),isNullable:!0}};case"object":{let i=Object.entries(t.controls),o={};for(let[r,n]of i){let a=Ve(n,e);a&&(o[r]=a)}return{type:e("object"),isNullable:!0,definitions:o}}case"vectorsetitem":return{type:e("vectorsetitem"),isNullable:!0};default:}}export{Re as a,Ie as b,Lt as c,Tt as d,De as e,Ve as f,ot as g,st as h,gt as i,Te as j,Me as k,xt as l,Oe as m,Ne as n,je as o};
//# sourceMappingURL=https://app.framerstatic.com/chunk-UYDBOT4S.mjs.map
