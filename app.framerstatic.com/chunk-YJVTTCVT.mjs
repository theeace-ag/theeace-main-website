import{s as n}from"https://app.framerstatic.com/chunk-PNIOO2GU.mjs";async function c(){try{return await navigator.permissions.query({name:"storage-access"})}catch{return{state:"prompt"}}}function a(){switch(window.location.origin){case"https://edit.framerlocal.com:8080":return"local";case"https://edit.development.framer.com":return"development";default:return"production"}}function i(){let e=new URL(window.location.href);e.searchParams.set("cookieMonsterDone","true");let t=new URL(window.location.origin);t.pathname="/cookie-monster",t.searchParams.set("continue",e.toString()),window.location.href=t.toString()}async function u(){let e=await fetch(`${n().api}/auth/web/access-token?source=editorbar`,{credentials:"include"});if(!e.ok)return;let t=await e.json(),{accessToken:s}=t;return s}async function d(e){try{let{jwtDecode:t}=await import("https://app.framerstatic.com/esm-7DVL7NZX.mjs");return t(e).userId}catch{return}}async function w(e){if("hasStorageAccess"in document&&!await document.hasStorageAccess())if((await c()).state==="granted")await document.requestStorageAccess();else return{status:"unknown"};let t=await u();if(!t)return{status:"no-auth"};let[s,r]=await Promise.all([d(t),fetch(`${n().api}/edit/sites/${e}/access`,{headers:{Authorization:`Bearer ${t}`}})]);if(!r.ok)switch(r.status){case 401:return a()==="development"&&new URLSearchParams(window.location.search).get("cookieMonsterDone")!=="true"?(i(),{status:"error"}):{status:"no-auth"};case 404:return{status:"no-access",userId:s};default:return{status:"error"}}let o;try{o=await r.json()}catch{return{status:"error"}}return o?.permissions?.canEditContent!=="on"?{status:"no-permission",userId:s}:{status:"success",data:o,userId:s}}export{w as a};
//# sourceMappingURL=https://app.framerstatic.com/chunk-YJVTTCVT.mjs.map
