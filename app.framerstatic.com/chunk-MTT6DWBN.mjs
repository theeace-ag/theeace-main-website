import{a as h,c as y,i as W,j as v,k as C,l as N,m as M,n as A,o as j,q as z,s as T,t as R,u as V,v as b,w as $}from"https://app.framerstatic.com/chunk-KYPY4QS7.mjs";var J=(e,t)=>e.selection.empty?!1:(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function _(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}var Y=(e,t,n)=>{let r=_(e,n);if(!r)return!1;let l=O(r);if(!l){let i=r.blockRange(),f=i&&C(i);return f==null?!1:(t&&t(e.tr.lift(i,f).scrollIntoView()),!0)}let o=l.nodeBefore;if(U(e,l,t,-1))return!0;if(r.parent.content.size==0&&(B(o,"end")||b.isSelectable(o)))for(let i=r.depth;;i--){let f=z(e.doc,r.before(i),r.after(i),y.empty);if(f&&f.slice.size<f.to-f.from){if(t){let s=e.tr.step(f);s.setSelection(B(o,"end")?T.findFrom(s.doc.resolve(s.mapping.map(l.pos,-1)),-1):b.create(s.doc,l.pos-o.nodeSize)),t(s.scrollIntoView())}return!0}if(i==1||r.node(i-1).childCount>1)break}return o.isAtom&&l.depth==r.depth-1?(t&&t(e.tr.delete(l.pos-o.nodeSize,l.pos).scrollIntoView()),!0):!1},xe=(e,t,n)=>{let r=_(e,n);if(!r)return!1;let l=O(r);return l?q(e,l,t):!1},we=(e,t,n)=>{let r=G(e,n);if(!r)return!1;let l=P(r);return l?q(e,l,t):!1};function q(e,t,n){let r=t.nodeBefore,l=r,o=t.pos-1;for(;!l.isTextblock;o--){if(l.type.spec.isolating)return!1;let a=l.lastChild;if(!a)return!1;l=a}let i=t.nodeAfter,f=i,s=t.pos+1;for(;!f.isTextblock;s++){if(f.type.spec.isolating)return!1;let a=f.firstChild;if(!a)return!1;f=a}let u=z(e.doc,o,s,y.empty);if(!u||u.from!=o||u instanceof W&&u.slice.size>=s-o)return!1;if(n){let a=e.tr.step(u);a.setSelection(V.create(a.doc,o)),n(a.scrollIntoView())}return!0}function B(e,t,n=!1){for(let r=e;r;r=t=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&r.childCount!=1)return!1}return!1}var Z=(e,t,n)=>{let{$head:r,empty:l}=e.selection,o=r;if(!l)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;o=O(r)}let i=o&&o.nodeBefore;return!i||!b.isSelectable(i)?!1:(t&&t(e.tr.setSelection(b.create(e.doc,o.pos-i.nodeSize)).scrollIntoView()),!0)};function O(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function G(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}var ee=(e,t,n)=>{let r=G(e,n);if(!r)return!1;let l=P(r);if(!l)return!1;let o=l.nodeAfter;if(U(e,l,t,1))return!0;if(r.parent.content.size==0&&(B(o,"start")||b.isSelectable(o))){let i=z(e.doc,r.before(),r.after(),y.empty);if(i&&i.slice.size<i.to-i.from){if(t){let f=e.tr.step(i);f.setSelection(B(o,"start")?T.findFrom(f.doc.resolve(f.mapping.map(l.pos)),1):b.create(f.doc,f.mapping.map(l.pos))),t(f.scrollIntoView())}return!0}}return o.isAtom&&l.depth==r.depth-1?(t&&t(e.tr.delete(l.pos,l.pos+o.nodeSize).scrollIntoView()),!0):!1},te=(e,t,n)=>{let{$head:r,empty:l}=e.selection,o=r;if(!l)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;o=P(r)}let i=o&&o.nodeAfter;return!i||!b.isSelectable(i)?!1:(t&&t(e.tr.setSelection(b.create(e.doc,o.pos)).scrollIntoView()),!0)};function P(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}var Se=(e,t)=>{let n=e.selection,r=n instanceof b,l;if(r){if(n.node.isTextblock||!A(e.doc,n.from))return!1;l=n.from}else if(l=j(e.doc,n.from,-1),l==null)return!1;if(t){let o=e.tr.join(l);r&&o.setSelection(b.create(o.doc,l-e.doc.resolve(l).nodeBefore.nodeSize)),t(o.scrollIntoView())}return!0},he=(e,t)=>{let n=e.selection,r;if(n instanceof b){if(n.node.isTextblock||!A(e.doc,n.to))return!1;r=n.to}else if(r=j(e.doc,n.to,1),r==null)return!1;return t&&t(e.tr.join(r).scrollIntoView()),!0},ye=(e,t)=>{let{$from:n,$to:r}=e.selection,l=n.blockRange(r),o=l&&C(l);return o==null?!1:(t&&t(e.tr.lift(l,o).scrollIntoView()),!0)},re=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!n.parent.type.spec.code||!n.sameParent(r)?!1:(t&&t(e.tr.insertText(`
`).scrollIntoView()),!0)};function F(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}var ne=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let l=n.node(-1),o=n.indexAfter(-1),i=F(l.contentMatchAt(o));if(!i||!l.canReplaceWith(o,o,i))return!1;if(t){let f=n.after(),s=e.tr.replaceWith(f,f,i.createAndFill());s.setSelection(T.near(s.doc.resolve(f),1)),t(s.scrollIntoView())}return!0},oe=(e,t)=>{let n=e.selection,{$from:r,$to:l}=n;if(n instanceof $||r.parent.inlineContent||l.parent.inlineContent)return!1;let o=F(l.parent.contentMatchAt(l.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let i=(!r.parentOffset&&l.index()<l.parent.childCount?r:l).pos,f=e.tr.insert(i,o.createAndFill());f.setSelection(V.create(f.doc,i+1)),t(f.scrollIntoView())}return!0},le=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let o=n.before();if(M(e.doc,o))return t&&t(e.tr.split(o).scrollIntoView()),!0}let r=n.blockRange(),l=r&&C(r);return l==null?!1:(t&&t(e.tr.lift(r,l).scrollIntoView()),!0)};function ie(e){return(t,n)=>{let{$from:r,$to:l}=t.selection;if(t.selection instanceof b&&t.selection.node.isBlock)return!r.parentOffset||!M(t.doc,r.pos)?!1:(n&&n(t.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let o=[],i,f,s=!1,u=!1;for(let c=r.depth;;c--)if(r.node(c).isBlock){s=r.end(c)==r.pos+(r.depth-c),u=r.start(c)==r.pos-(r.depth-c),f=F(r.node(c-1).contentMatchAt(r.indexAfter(c-1)));let k=e&&e(l.parent,s,r);o.unshift(k||(s&&f?{type:f}:null)),i=c;break}else{if(c==1)return!1;o.unshift(null)}let a=t.tr;(t.selection instanceof V||t.selection instanceof $)&&a.deleteSelection();let m=a.mapping.map(r.pos),d=M(a.doc,m,o.length,o);if(d||(o[0]=f?{type:f}:null,d=M(a.doc,m,o.length,o)),a.split(m,o.length,o),!s&&u&&r.node(i).type!=f){let c=a.mapping.map(r.before(i)),p=a.doc.resolve(c);f&&r.node(i-1).canReplaceWith(p.index(),p.index()+1,f)&&a.setNodeMarkup(a.mapping.map(r.before(i)),f)}return n&&n(a.scrollIntoView()),!0}}var H=ie(),Ae=(e,t)=>H(e,t&&(n=>{let r=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();r&&n.ensureMarks(r),t(n)})),Be=(e,t)=>{let{$from:n,to:r}=e.selection,l,o=n.sharedDepth(r);return o==0?!1:(l=n.before(o),t&&t(e.tr.setSelection(b.create(e.doc,l))),!0)},fe=(e,t)=>(t&&t(e.tr.setSelection(new $(e.doc))),!0);function se(e,t,n){let r=t.nodeBefore,l=t.nodeAfter,o=t.index();return!r||!l||!r.type.compatibleContent(l.type)?!1:!r.content.size&&t.parent.canReplace(o-1,o)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!t.parent.canReplace(o,o+1)||!(l.isTextblock||A(e.doc,t.pos))?!1:(n&&n(e.tr.join(t.pos).scrollIntoView()),!0)}function U(e,t,n,r){let l=t.nodeBefore,o=t.nodeAfter,i,f,s=l.type.spec.isolating||o.type.spec.isolating;if(!s&&se(e,t,n))return!0;let u=!s&&t.parent.canReplace(t.index(),t.index()+1);if(u&&(i=(f=l.contentMatchAt(l.childCount)).findWrapping(o.type))&&f.matchType(i[0]||o.type).validEnd){if(n){let c=t.pos+o.nodeSize,p=h.empty;for(let x=i.length-1;x>=0;x--)p=h.from(i[x].create(null,p));p=h.from(l.copy(p));let k=e.tr.step(new v(t.pos-1,c,t.pos,c,new y(p,1,0),i.length,!0)),g=k.doc.resolve(c+2*i.length);g.nodeAfter&&g.nodeAfter.type==l.type&&A(k.doc,g.pos)&&k.join(g.pos),n(k.scrollIntoView())}return!0}let a=o.type.spec.isolating||r>0&&s?null:T.findFrom(t,1),m=a&&a.$from.blockRange(a.$to),d=m&&C(m);if(d!=null&&d>=t.depth)return n&&n(e.tr.lift(m,d).scrollIntoView()),!0;if(u&&B(o,"start",!0)&&B(l,"end")){let c=l,p=[];for(;p.push(c),!c.isTextblock;)c=c.lastChild;let k=o,g=1;for(;!k.isTextblock;k=k.firstChild)g++;if(c.canReplace(c.childCount,c.childCount,k.content)){if(n){let x=h.empty;for(let S=p.length-1;S>=0;S--)x=h.from(p[S].copy(x));let I=e.tr.step(new v(t.pos-p.length,t.pos+o.nodeSize,t.pos+g,t.pos+o.nodeSize-g,new y(x,p.length,0),0,!0));n(I.scrollIntoView())}return!0}}return!1}function L(e){return function(t,n){let r=t.selection,l=e<0?r.$from:r.$to,o=l.depth;for(;l.node(o).isInline;){if(!o)return!1;o--}return l.node(o).isTextblock?(n&&n(t.tr.setSelection(V.create(t.doc,e<0?l.start(o):l.end(o)))),!0):!1}}var ce=L(-1),ae=L(1);function Ie(e,t=null){return function(n,r){let{$from:l,$to:o}=n.selection,i=l.blockRange(o),f=i&&N(i,e,t);return f?(r&&r(n.tr.wrap(i,f).scrollIntoView()),!0):!1}}function Ce(e,t=null){return function(n,r){let l=!1;for(let o=0;o<n.selection.ranges.length&&!l;o++){let{$from:{pos:i},$to:{pos:f}}=n.selection.ranges[o];n.doc.nodesBetween(i,f,(s,u)=>{if(l)return!1;if(!(!s.isTextblock||s.hasMarkup(e,t)))if(s.type==e)l=!0;else{let a=n.doc.resolve(u),m=a.index();l=a.parent.canReplaceWith(m,m+1,e)}})}if(!l)return!1;if(r){let o=n.tr;for(let i=0;i<n.selection.ranges.length;i++){let{$from:{pos:f},$to:{pos:s}}=n.selection.ranges[i];o.setBlockType(f,s,e,t)}r(o.scrollIntoView())}return!0}}function ue(e,t,n,r){for(let l=0;l<t.length;l++){let{$from:o,$to:i}=t[l],f=o.depth==0?e.inlineContent&&e.type.allowsMarkType(n):!1;if(e.nodesBetween(o.pos,i.pos,(s,u)=>{if(f||!r&&s.isAtom&&s.isInline&&u>=o.pos&&u+s.nodeSize<=i.pos)return!1;f=s.inlineContent&&s.type.allowsMarkType(n)}),f)return!0}return!1}function pe(e){let t=[];for(let n=0;n<e.length;n++){let{$from:r,$to:l}=e[n];r.doc.nodesBetween(r.pos,l.pos,(o,i)=>{if(o.isAtom&&o.content.size&&o.isInline&&i>=r.pos&&i+o.nodeSize<=l.pos)return i+1>r.pos&&t.push(new R(r,r.doc.resolve(i+1))),r=r.doc.resolve(i+1+o.content.size),!1}),r.pos<l.pos&&t.push(new R(r,l))}return t}function Me(e,t=null,n){let r=(n&&n.removeWhenPresent)!==!1,l=(n&&n.enterInlineAtoms)!==!1;return function(o,i){let{empty:f,$cursor:s,ranges:u}=o.selection;if(f&&!s||!ue(o.doc,u,e,l))return!1;if(i)if(s)e.isInSet(o.storedMarks||s.marks())?i(o.tr.removeStoredMark(e)):i(o.tr.addStoredMark(e.create(t)));else{let a,m=o.tr;l||(u=pe(u)),r?a=!u.some(d=>o.doc.rangeHasMark(d.$from.pos,d.$to.pos,e)):a=!u.every(d=>{let c=!1;return m.doc.nodesBetween(d.$from.pos,d.$to.pos,(p,k,g)=>{if(c)return!1;c=!e.isInSet(p.marks)&&!!g&&g.type.allowsMarkType(e)&&!(p.isText&&/^\s*$/.test(p.textBetween(Math.max(0,d.$from.pos-k),Math.min(p.nodeSize,d.$to.pos-k))))}),!c});for(let d=0;d<u.length;d++){let{$from:c,$to:p}=u[d];if(!a)m.removeMark(c.pos,p.pos,e);else{let k=c.pos,g=p.pos,x=c.nodeAfter,I=p.nodeBefore,S=x&&x.isText?/^\s*/.exec(x.text)[0].length:0,X=I&&I.isText?/\s*$/.exec(I.text)[0].length:0;k+S<g&&(k+=S,g-=X),m.addMark(k,g,e.create(t))}}i(m.scrollIntoView())}return!0}}function de(e,t){return n=>{if(!n.isGeneric)return e(n);let r=[];for(let o=0;o<n.mapping.maps.length;o++){let i=n.mapping.maps[o];for(let f=0;f<r.length;f++)r[f]=i.map(r[f]);i.forEach((f,s,u,a)=>r.push(u,a))}let l=[];for(let o=0;o<r.length;o+=2){let i=r[o],f=r[o+1],s=n.doc.resolve(i),u=s.sharedDepth(f),a=s.node(u);for(let m=s.indexAfter(u),d=s.after(u+1);d<=f;++m){let c=a.maybeChild(m);if(!c)break;if(m&&l.indexOf(d)==-1){let p=a.child(m-1);p.type==c.type&&t(p,c)&&l.push(d)}d+=c.nodeSize}}l.sort((o,i)=>o-i);for(let o=l.length-1;o>=0;o--)A(n.doc,l[o])&&n.join(l[o]);e(n)}}function Te(e,t){let n=Array.isArray(t)?r=>t.indexOf(r.type.name)>-1:t;return(r,l,o)=>e(r,l&&de(l,n),o)}function E(...e){return function(t,n,r){for(let l=0;l<e.length;l++)if(e[l](t,n,r))return!0;return!1}}var D=E(J,Y,Z),K=E(J,ee,te),w={Enter:E(re,oe,le,H),"Mod-Enter":ne,Backspace:D,"Mod-Backspace":D,"Shift-Backspace":D,Delete:K,"Mod-Delete":K,"Mod-a":fe},Q={"Ctrl-h":w.Backspace,"Alt-Backspace":w["Mod-Backspace"],"Ctrl-d":w.Delete,"Ctrl-Alt-Backspace":w["Mod-Delete"],"Alt-Delete":w["Mod-Delete"],"Alt-d":w["Mod-Delete"],"Ctrl-a":ce,"Ctrl-e":ae};for(let e in w)Q[e]=w[e];var me=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform?os.platform()=="darwin":!1,Ve=me?Q:w;export{J as a,Y as b,xe as c,we as d,Z as e,ee as f,te as g,Se as h,he as i,ye as j,re as k,ne as l,oe as m,le as n,ie as o,H as p,Ae as q,Be as r,fe as s,ce as t,ae as u,Ie as v,Ce as w,Me as x,Te as y,E as z,w as A,Q as B,Ve as C};
//# sourceMappingURL=https://app.framerstatic.com/chunk-MTT6DWBN.mjs.map
