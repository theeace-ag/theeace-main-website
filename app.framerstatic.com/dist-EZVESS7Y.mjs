import{p as v,y as C}from"https://app.framerstatic.com/chunk-KYPY4QS7.mjs";import"https://app.framerstatic.com/chunk-AHQIRSXG.mjs";function V(g={}){return new C({view(e){return new m(e,g)}})}var m=class{constructor(e,t){var i;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(i=t.width)!==null&&i!==void 0?i:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let d=r=>{this[o](r)};return e.dom.addEventListener(o,d),{name:o,handler:d}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,i,o=this.editorView.dom,d=o.getBoundingClientRect(),r=d.width/o.offsetWidth,h=d.height/o.offsetHeight;if(t){let s=e.nodeBefore,n=e.nodeAfter;if(s||n){let a=this.editorView.nodeDOM(this.cursorPos-(s?s.nodeSize:0));if(a){let c=a.getBoundingClientRect(),u=s?c.bottom:c.top;s&&n&&(u=(u+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let w=this.width/2*h;i={left:c.left,right:c.right,top:u-w,bottom:u+w}}}}if(!i){let s=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*r;i={left:s.left-n,right:s.left+n,top:s.top,bottom:s.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let f,p;if(!l||l==document.body&&getComputedStyle(l).position=="static")f=-pageXOffset,p=-pageYOffset;else{let s=l.getBoundingClientRect(),n=s.width/l.offsetWidth,a=s.height/l.offsetHeight;f=s.left-l.scrollLeft*n,p=s.top-l.scrollTop*a}this.element.style.left=(i.left-f)/r+"px",this.element.style.top=(i.top-p)/h+"px",this.element.style.width=(i.right-i.left)/r+"px",this.element.style.height=(i.bottom-i.top)/h+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),i=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),o=i&&i.type.spec.disableDropCursor,d=typeof o=="function"?o(this.editorView,t,e):o;if(t&&!d){let r=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let h=v(this.editorView.state.doc,r,this.editorView.dragging.slice);h!=null&&(r=h)}this.setCursor(r),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}};export{V as dropCursor};
//# sourceMappingURL=https://app.framerstatic.com/dist-EZVESS7Y.mjs.map
